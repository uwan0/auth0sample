<!DOCTYPE html>
<html>
<head>
    <title>search dialog</title>
    <meta charset="UTF-8">
    <style>
      form.testForm{background-color: #cc0; color: #ff0000; }	
	    .hidden{display: none;}
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js" integrity="sha512-YUkaLm+KJ5lQXDBdqBqk7EVhJAdxRnVdT2vtCzwPHSweCzyMgYV/tgGF4/dCyqtCC2eCphz0lRQgatGVdfR0ww==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
</head>
<body>
<script>
	const token = $.cookie("AccessToken");
</script>
	<p><h1>落ち呼情報検索</h1></p>
        <p>
    <form>
	<label>電話番号：<input type="text" name="phoneNum" id="sbmphone" maxlength="11"></label>
        <input type="button" id="sbmbtn" value="検索">
    </form>
        </p><br>
<input type="button" value="検索画面を閉じる" onClick="window.close()">
<div id="search"></div>
<script>
$(function () {
  $(document).on("click", "#sbmbtn", function() {
    $.ajax({
      url: "https://re-delivery-prod.apigee.net/v1/operations/htmlresp",
      type: "GET",
      headers: {
//	'Access-Control-Allow-Origin': 'https://uwan0.github.io',
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${ token} `
      },
      dataType: "json",
      data: {phoneNum: $("#sbmphone").val()}
    })
      .done((data, textStatus, jqXHR) => {
        console.log('done', jqXHR.status, data);
        $("#search").html(data);
      })
      .fail((jqXHR, textStatus, errorThrown) => {
        console.log('fail', jqXHR.status);
      })
  })
})
</script>
</body>
</html>
